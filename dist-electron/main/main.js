"use strict";const e=require("electron"),p=require("node:os"),s=require("node:path");process.env.DIST_ELECTRON=s.join(__dirname,"..");process.env.DIST=s.join(process.env.DIST_ELECTRON,"../dist");process.env.PUBLIC=process.env.VITE_DEV_SERVER_URL?s.join(process.env.DIST_ELECTRON,"../public"):process.env.DIST;p.release().startsWith("6.1")&&e.app.disableHardwareAcceleration();process.platform==="win32"&&e.app.setAppUserModelId(e.app.getName());e.app.requestSingleInstanceLock()||(e.app.quit(),process.exit(0));let n=null;const r=s.join(__dirname,"../preload/main.ts"),a=process.env.VITE_DEV_SERVER_URL,c=s.join(process.env.DIST,"index.html");async function l(){n=new e.BrowserWindow({title:"Main window",icon:s.join(process.env.PUBLIC||"","favicon.ico"),webPreferences:{preload:r,nodeIntegration:!0,contextIsolation:!1}}),process.env.VITE_DEV_SERVER_URL?(n.loadURL(a||""),n.webContents.openDevTools()):n.loadFile(c),n.webContents.on("did-finish-load",()=>{n==null||n.webContents.send("main-process-message",new Date().toLocaleString())}),n.webContents.setWindowOpenHandler(({url:o})=>(o.startsWith("https:")&&e.shell.openExternal(o),{action:"deny"}))}e.app.whenReady().then(l);e.app.on("window-all-closed",()=>{n=null,process.platform!=="darwin"&&e.app.quit()});e.app.on("second-instance",()=>{n&&(n.isMinimized()&&n.restore(),n.focus())});e.app.on("activate",()=>{const o=e.BrowserWindow.getAllWindows();o.length?o[0].focus():l()});e.ipcMain.handle("open-win",(o,i)=>{const t=new e.BrowserWindow({webPreferences:{preload:r,nodeIntegration:!0,contextIsolation:!1}});process.env.VITE_DEV_SERVER_URL?t.loadURL(`${a}#${i}`):t.loadFile(c,{hash:i})});
